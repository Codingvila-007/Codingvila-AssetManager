<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Codingvila | Professional Image Storage</title>
    <!-- Assets -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.1.0/mdb.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- AUTH SECTION -->
    <div id="login-overlay" class="auth-screen">
        <div class="card login-card shadow-5-strong border-0">
            <div class="card-body p-5 text-center">
                <div class="brand-logo mb-4">
                    <i class="fas fa-box-open fa-3x text-primary"></i>
                    <h3 class="fw-bold mt-2">Codingvila</h3>
                    <p class="text-muted small">Cloud Asset Manager</p>
                </div>
                <div class="form-outline mb-4" data-mdb-input-init>
                    <input type="text" id="login-user" class="form-control" value="admin" />
                    <label class="form-label">Username</label>
                </div>
                <div class="form-outline mb-4" data-mdb-input-init>
                    <input type="password" id="login-pass" class="form-control" value="admin123" />
                    <label class="form-label">Password</label>
                </div>
                <button id="btn-login" class="btn btn-primary btn-block btn-lg shadow-0 rounded-pill">Login</button>
                <div class="mt-4 pt-3 border-top">
                    <p class="x-small text-muted mb-0">For any query, technical issue, or password reset, please contact the developer.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN WRAPPER -->
    <div id="app-wrapper" style="display:none;">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top shadow-0">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" id="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>

                <a class="navbar-brand ms-2 d-flex align-items-center gap-2" href="#">
                    <i class="fas fa-box-open fa-lg text-white"></i>
                    <strong>Codingvila</strong>
                </a>

                <div class="ms-auto d-flex align-items-center text-white">
                    <span class="me-3 small d-none d-md-inline">
                        <i class="fas fa-user-shield me-1"></i> Admin
                    </span>
                    <button id="btn-logout" class="text-white btn btn-outline-white btn-sm rounded-pill px-3">
                        Logout
                    </button>
                </div>
            </div>
        </nav>


        <div class="d-flex h-100">
            <!-- SIDEBAR -->
            <nav id="sidebar" class="sidebar shadow-2">
                <div class="list-group list-group-flush mt-4" id="app-tabs">
                    <a href="#" class="list-group-item list-group-item-action py-3 active" data-tab="dashboard">
                        <i class="fas fa-chart-pie me-3"></i>Dashboard
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3" data-tab="upload">
                        <i class="fas fa-cloud-upload-alt me-3"></i>Upload Center
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3" data-tab="library">
                        <i class="fas fa-layer-group me-3"></i>Image Library
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3" data-tab="gallery">
                        <i class="fas fa-th me-3"></i>Gallery View
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3" data-tab="backup">
                        <i class="fas fa-server me-3"></i>Backup & Restore
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3" data-tab="cleanup">
                        <i class="fas fa-broom me-3"></i>Data Cleanup
                    </a>
                </div>
            </nav>

            <main class="content-area p-4 w-100">
                <!-- DASHBOARD -->
                <section id="tab-dashboard" class="tab-pane active">
                    <div class="row g-4 mb-4">
                        <div class="col-md-3">
                            <div class="stat-card shadow-1 p-4 bg-white border-start border-primary border-5 rounded-3">
                                <h6 class="text-muted x-small fw-bold text-uppercase mb-1">Total Assets</h6>
                                <h2 id="metric-total" class="mb-0">0</h2>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card shadow-1 p-4 bg-white border-start border-success border-5 rounded-3">
                                <h6 class="text-muted x-small fw-bold text-uppercase mb-1">Total Downloads</h6>
                                <h2 id="metric-downloads" class="mb-0">0</h2>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card shadow-1 p-4 bg-white border-start border-warning border-5 rounded-3">
                                <h6 class="text-muted x-small fw-bold text-uppercase mb-1">New Today</h6>
                                <h2 id="metric-today" class="mb-0">0</h2>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card shadow-1 p-4 bg-white border-start border-info border-5 rounded-3">
                                <h6 class="text-muted x-small fw-bold text-uppercase mb-1">Storage Usage</h6>
                                <h2 id="metric-size" class="mb-0">0 KB</h2>
                            </div>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-md-8">
                            <div class="card shadow-2 h-100 border-0">
                                <div class="card-body">
                                    <h5 class="card-title fw-bold">Upload Trends</h5>
                                    <canvas id="chartTrend" height="120"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card shadow-2 h-100 border-0">
                                <div class="card-body">
                                    <h5 class="card-title fw-bold">Extensions</h5>
                                    <canvas id="chartPie" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- UPLOAD -->
                <section id="tab-upload" class="tab-pane d-none">
                    <div class="card shadow-2 border-0 overflow-hidden">
                        <div class="card-body p-5 text-center">
                            <div id="drop-zone" class="upload-zone">
                                <div class="p-5">
                                    <i class="fas fa-cloud-arrow-up fa-4x text-primary mb-3"></i>
                                    <h4>Drop Images Here</h4>
                                    <p class="text-muted">Supports JPG, PNG, GIF, WEBP</p>
                                    <input type="file" id="input-files" multiple accept="image/*" class="d-none">
                                    <button class="btn btn-primary rounded-pill px-5" onclick="$('#input-files').click()">Browse Files</button>
                                </div>
                            </div>
                            <div id="preview-container" class="row g-3 mt-4"></div>
                            <div id="upload-status" class="mt-4 d-none">
                                <div class="progress rounded-pill mb-2" style="height: 12px;">
                                    <div id="upload-progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" style="width: 0%"></div>
                                </div>
                                <span id="upload-progress-text" class="small fw-bold text-primary">Preparing...</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- LIBRARY -->
                <section id="tab-library" class="tab-pane d-none">
                    <div class="card shadow-2 border-0">
                        <div class="card-header bg-white py-3 border-0">
                            <div class="row align-items-center g-3">
                                <div class="col-lg-3">
                                    <div class="form-outline" data-mdb-input-init>
                                        <input type="text" id="lib-search" class="form-control" />
                                        <label class="form-label">Search files...</label>
                                    </div>
                                </div>
                                <div class="col-lg-2">
                                    <select id="lib-grouping" class="form-select border-light">
                                        <option value="">No Grouping</option>
                                        <option value="date">Group by Day</option>
                                        <option value="month">Group by Month</option>
                                        <option value="year">Group by Year</option>
                                    </select>
                                </div>
                                <div class="col-lg-2">
                                    <select id="lib-sort" class="form-select border-light">
                                        <option value="desc">Newest First</option>
                                        <option value="asc">Oldest First</option>
                                        <option value="name">Sort A-Z</option>
                                    </select>
                                </div>
                                <div class="col-lg-5 text-end d-flex gap-2 justify-content-end">
                                    <div class="dropdown">
                                        <button class="btn btn-success btn-sm dropdown-toggle shadow-0" type="button" data-mdb-dropdown-init>
                                            <i class="fas fa-file-excel me-1"></i> Excel
                                        </button>
                                        <ul class="dropdown-menu shadow-3">
                                            <li><a class="dropdown-item" href="#" onclick="exportBatchExcel('all')">Export All</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="exportBatchExcel('selected')">Export Selected</a></li>
                                        </ul>
                                    </div>
                                    <div class="dropdown">
                                        <button class="btn btn-dark btn-sm dropdown-toggle shadow-0" type="button" data-mdb-dropdown-init>
                                            <i class="fas fa-file-download me-1"></i> Download
                                        </button>
                                        <ul class="dropdown-menu shadow-3">
                                            <li>
                                                <a class="dropdown-item" href="#" onclick="processDirectDownload('all')">
                                                    <i class="fas fa-download me-2"></i>Download All
                                                </a>
                                            </li>
                                            <li>
                                                <a class="dropdown-item" href="#" onclick="processDirectDownload('selected')">
                                                    <i class="fas fa-check-square me-2"></i>Download Selected
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive" id="lib-scroll-container" style="max-height: 60vh;">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="table-light sticky-top">
                                        <tr>
                                            <th style="width: 45px;"><input type="checkbox" id="lib-check-all" class="form-check-input"></th>
                                            <th style="width: 80px;">Preview</th>
                                            <th>Asset Name</th>
                                            <th>Uploaded</th>
                                            <th>Asset URL</th>
                                            <th class="text-center">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="lib-table-body"></tbody>
                                </table>
                                <div id="lib-load-spinner" class="text-center p-4 d-none">
                                    <div class="spinner-border spinner-border-sm text-primary"></div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer bg-white py-3 border-0 d-flex justify-content-between">
                            <span id="lib-info" class="small text-muted"></span>
                        </div>
                    </div>
                </section>

                <!-- GALLERY -->
                <section id="tab-gallery" class="tab-pane d-none">
                    <div class="card card-body shadow-1 border-0 mb-4 py-2">
                        <div class="row align-items-center g-3">
                            <div class="col-md-4">
                                <div class="form-outline" data-mdb-input-init>
                                    <input type="text" id="gal-search" class="form-control" />
                                    <label class="form-label">Search Gallery...</label>
                                </div>
                            </div>
                            <div class="col-md-8 text-end">
                                <button class="btn btn-primary btn-sm shadow-0 rounded-pill me-2" onclick="startSlideshow()">
                                    <i class="fas fa-play me-1"></i> Slideshow
                                </button>
                                <button class="btn btn-outline-primary btn-sm rounded-pill" onclick="processDirectDownload('gal-selected')">
                                    <i class="fas fa-download me-1"></i> Download Selected
                                </button>
                            </div>
                        </div>
                    </div>
                    <div id="gallery-container" class="row g-4"></div>
                    <div class="text-center my-5">
                        <button id="btn-gal-more" class="btn btn-primary btn-lg px-5 rounded-pill d-none shadow-0">Load More</button>
                    </div>
                </section>

                <!-- CLEANUP -->
                <section id="tab-cleanup" class="tab-pane d-none">
                    <div class="card shadow-2 border-danger border-top border-5">
                        <div class="card-body p-4">
                            <h4 class="fw-bold text-danger mb-4"><i class="fas fa-shield-alt me-2"></i>Asset Management Console</h4>
                            <div class="row g-4">
                                <div class="col-md-3">
                                    <div class="p-3 border rounded-3 bg-light h-100">
                                        <label class="small fw-bold mb-2">Delete by Day</label>
                                        <input type="date" id="clean-day" class="form-control mb-3">
                                        <button class="btn btn-danger btn-sm btn-block shadow-0" onclick="runCleanup('day')">Clean Day</button>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="p-3 border rounded-3 bg-light h-100">
                                        <label class="small fw-bold mb-2">Delete by Month</label>
                                        <input type="month" id="clean-month" class="form-control mb-3">
                                        <button class="btn btn-danger btn-sm btn-block shadow-0" onclick="runCleanup('month')">Clean Month</button>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="p-3 border rounded-3 bg-light h-100">
                                        <label class="small fw-bold mb-2">Delete by Year</label>
                                        <input type="number" id="clean-year" class="form-control mb-3" placeholder="2025" min="2020">
                                        <button class="btn btn-danger btn-sm btn-block shadow-0" onclick="runCleanup('year')">Clean Year</button>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="p-3 border border-danger rounded-3 bg-light h-100 d-flex flex-column">
                                        <label class="small fw-bold mb-2 text-danger">Master Purge</label>
                                        <p class="x-small text-muted">Remove all asset records from local storage.</p>
                                        <button class="btn btn-outline-danger btn-sm btn-block mt-auto shadow-0" onclick="runCleanup('all')">Purge All Data</button>
                                    </div>
                                </div>
                            </div>
                </section>

                <!-- BACKUP DB -->
                <!-- DATABASE BACKUP & RESTORE -->
                <section id="tab-backup" class="tab-pane d-none">
                    <div class="card shadow-2 rounded-4 border-0">
                        <div class="card-body p-4">
                            <div class="d-flex align-items-center mb-4">
                                <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                                    <i class="fas fa-server text-primary fa-lg"></i>
                                </div>
                                <div>
                                    <h4 class="fw-bold mb-0">Database Governance</h4>
                                    <p class="text-muted small mb-0">Manage and migrate your centralized asset metadata</p>
                                </div>
                            </div>

                            <div class="row g-4">
                                <!-- BACKUP CARD -->
                                <div class="col-md-6">
                                    <div class="action-card p-4 border rounded-4 bg-light h-100 text-center transition-hover">
                                        <div class="icon-circle mb-3 mx-auto">
                                            <i class="fas fa-cloud-download-alt fa-2x text-primary"></i>
                                        </div>
                                        <h5 class="fw-bold">Export Database</h5>
                                        <p class="text-muted small mb-4">Generate a portable JSON backup of your current cloud asset library to save locally.</p>
                                        <button onclick="backupDB()" class="btn btn-primary rounded-pill px-4 shadow-0">
                                            <i class="fas fa-file-export me-2"></i>Backup Now
                                        </button>
                                    </div>
                                </div>

                                <!-- RESTORE CARD -->
                                <div class="col-md-6">
                                    <div class="action-card p-4 border rounded-4 bg-light h-100 text-center transition-hover">
                                        <div class="icon-circle mb-3 mx-auto">
                                            <i class="fas fa-cloud-upload-alt fa-2x text-success"></i>
                                        </div>
                                        <h5 class="fw-bold">Restore Database</h5>
                                        <p class="text-muted small mb-4">Upload a previously exported JSON file to restore your asset library or migrate data.</p>

                                        <!-- Styled File Trigger -->
                                        <input type="file" id="input-restore"
                                               accept=".json" class="d-none"
                                               onchange="restoreDB(this.files[0])">
                                        <button onclick="$('#input-restore').click()" class="btn btn-outline-success rounded-pill px-4 shadow-0">
                                            <i class="fas fa-file-import me-2"></i>Choose Backup File
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="alert alert-info mt-4 rounded-4 border-0 shadow-0 d-flex align-items-center">
                                <i class="fas fa-info-circle me-3 fa-lg"></i>
                                <small>Backup files contain metadata links only. The actual images remain securely stored on the ImgBB servers.</small>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- VIEW MODAL -->
    <div class="modal fade" id="viewModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content bg-transparent shadow-0 border-0">
                <div class="slideshow-controls text-center mb-3 d-none" id="ss-ui">
                    <button class="btn btn-light btn-floating mx-1" onclick="shiftSlide(-1)"><i class="fas fa-chevron-left"></i></button>
                    <button class="btn btn-light btn-floating mx-1" id="ss-play" onclick="toggleSS()"><i class="fas fa-pause"></i></button>
                    <button class="btn btn-light btn-floating mx-1" onclick="shiftSlide(1)"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="text-center position-relative">
                    <img id="modal-img" src="" class="img-fluid rounded-4 shadow-5 mx-auto" style="max-height: 80vh;">
                    <div class="mt-3">
                        <button class="btn btn-light btn-floating mx-2 shadow-2" id="modal-dl" title="Download Asset"><i class="fas fa-download text-primary"></i></button>
                        <button class="btn btn-light btn-floating mx-2 shadow-2" id="modal-copy" title="Copy Link"><i class="fas fa-link text-info"></i></button>
                        <button class="btn btn-light btn-floating mx-2 shadow-2" data-mdb-dismiss="modal"><i class="fas fa-times text-danger"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer fixed-bottom py-3 bg-white border-top shadow-1">
        <div class="container-fluid text-center">
            <small class="text-muted">Â© 2025 <b>Codingvila</b>. All Rights Reserved. Developed by <b>Nikunj Satasiya</b>. Powered by <a href="https://www.codingvila.com" target="_blank" class="text-primary fw-bold">Codingvila.com</a></small>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.1.0/mdb.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/6.0.0/bootbox.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="app.js"></script>
</body>
</html>